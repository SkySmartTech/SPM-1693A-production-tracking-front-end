import{r as l,e as le,a0 as D,j as e,B as n,f as ce,i as de,k as he,T as s,D as B,a1 as O,C as xe,m as V}from"./index-DbvNdllW.js";import{T as f,A as G,D as q,F as pe,P as me,a as M}from"./AdapterDayjs-BNj1M8pu.js";import{A as fe,I as g,M as ue,B as je,N as ge,F as ye}from"./Notifications-j6OMPz9m.js";import{M as H,B as d,A as ve}from"./AccountCircle-BqrC-WHa.js";import{F as be}from"./Footer-Bc1dpBWo.js";import{M as h}from"./MenuItem-BE8l7ryc.js";import{G as i}from"./Grid-B2YnSNSE.js";import{C as x}from"./Card-DQiV8G8E.js";import{C as p}from"./CardContent-DpO8IoKg.js";import{S as Ce}from"./Stack-D3HsYBR0.js";import{S as we,A as Me}from"./Snackbar-sTGnc7Nj.js";import{D as Se}from"./DataGrid-L6zcZlJN.js";import"./useFormControl-DDGvswHg.js";import"./InputLabel-BJ-Hgfal.js";import"./Select-1bWPsc-P.js";import"./isMuiElement-qTM6GdlR.js";import"./TextField-CsoWppMA.js";import"./InputAdornment-COHC8bxC.js";import"./DialogContent-Zf1qvqUe.js";import"./ListItem-CzJ2TJw9.js";import"./styled-Cs-gJYMi.js";import"./ClickAwayListener-Ba4dolDx.js";import"./FormControlLabel-BtOoiiGH.js";import"./SwitchBase-Cr_0Qc_S.js";import"./KeyboardArrowRight-vsqFBlkf.js";import"./TableCell-wBWqAFyv.js";const ke=[{field:"id",headerName:"ID",width:80},{field:"serverDateTime",headerName:"Server Date Time",width:180},{field:"lineNo",headerName:"Line No",width:100},{field:"buyer",headerName:"Buyer",width:120},{field:"style",headerName:"Style",width:120},{field:"color",headerName:"Color",width:100},{field:"size",headerName:"Size",width:80},{field:"success",headerName:"Success",width:100,type:"number"},{field:"rework",headerName:"Rework",width:100,type:"number"},{field:"defect",headerName:"Defect",width:100,type:"number"}],Ee=async(o,c)=>{const t={};return o&&(t.start_date=o.format("YYYY-MM-DD")),c&&(t.end_date=c.format("YYYY-MM-DD")),(await V.get("https://perahara.lk/SPM-1693A-backend-production-tracking/public/dayplan-reports",{params:t})).data},Ie=async(o,c)=>{const t={};return o&&(t.start_date=o.format("YYYY-MM-DD")),c&&(t.end_date=c.format("YYYY-MM-DD")),(await V.get("https://perahara.lk/SPM-1693A-backend-production-tracking/public/performance-metrics",{params:t})).data},rr=()=>{var Y,R,L,T;const[o,c]=l.useState(null),[t,y]=l.useState(null),[S,k]=l.useState(!1),[_,E]=l.useState(!1),[I,N]=l.useState(null),[P,F]=l.useState(null),[A]=l.useState(3),[m,v]=l.useState({open:!1,message:"",severity:"success"}),b=le(),[W,K]=l.useState({pageSize:10,page:0}),{data:U,isLoading:$,isError:Q,refetch:J}=D({queryKey:["dayplan-reports",o,t],queryFn:()=>Ee(o,t),enabled:!1}),{data:r,isLoading:X,isError:Z,refetch:ee}=D({queryKey:["performance-metrics",o,t],queryFn:()=>Ie(o,t),enabled:!1}),re=async()=>{if(!o||!t){C("Please select both start and end dates.","error");return}try{await Promise.all([J(),ee()]),C("Reports fetched successfully","success")}catch(a){console.error("Error fetching reports:",a),C("Failed to fetch reports","error")}},C=(a,j)=>{v({open:!0,message:a,severity:j})},se=a=>{N(a.currentTarget)},w=()=>{N(null)},te=()=>{b("/userProfile"),w()},oe=()=>{b("/login"),w()},ne=a=>{F(a.currentTarget)},z=()=>{F(null)},ie=()=>{b("/notifications"),z()},u=$||X,ae=Q||Z;return e.jsxs(n,{sx:{display:"flex",width:"100vw",height:"100vh",minHeight:"100vh",backgroundColor:"#f5f5f5"},children:[e.jsx(ce,{}),e.jsx(de,{open:S||_,setOpen:k,onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1)}),e.jsxs(n,{sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(fe,{position:"static",sx:{bgcolor:"white",boxShadow:2},children:e.jsxs(he,{children:[e.jsx(g,{edge:"start",onClick:()=>k(!S),children:e.jsx(ue,{})}),e.jsx(s,{variant:"h6",sx:{flexGrow:1,color:"black"},children:"Day Plan Report"}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(g,{onClick:ne,children:e.jsx(je,{badgeContent:A,color:"error",children:e.jsx(ge,{})})}),e.jsxs(H,{anchorEl:P,open:!!P,onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{"& .MuiPaper-root":{width:300,maxHeight:400}},children:[e.jsx(h,{disabled:!0,children:e.jsxs(s,{variant:"body2",children:["You have ",A," new notifications"]})}),e.jsx(B,{}),e.jsx(h,{children:e.jsx(s,{variant:"body2",children:"Notification 1"})}),e.jsx(h,{children:e.jsx(s,{variant:"body2",children:"Notification 2"})}),e.jsx(B,{}),e.jsx(h,{onClick:ie,children:e.jsx(d,{fullWidth:!0,variant:"contained",size:"small",children:"View All Notifications"})})]}),e.jsx(g,{onClick:()=>document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen(),children:e.jsx(ye,{})}),e.jsx(g,{onClick:se,children:e.jsx(ve,{})}),e.jsxs(H,{anchorEl:I,open:!!I,onClose:w,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsx(h,{onClick:te,children:"User Profile"}),e.jsx(h,{onClick:oe,children:"Logout"})]})]})]})}),e.jsxs(n,{sx:{p:3,flexGrow:1,overflow:"auto"},children:[e.jsx(s,{variant:"h6",sx:{mb:2},children:"Details"}),e.jsxs(i,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:2,children:e.jsx(x,{sx:{height:"100%"},children:e.jsxs(p,{children:[e.jsx(s,{variant:"body2",color:"text.secondary",children:"Performance EFI"}),e.jsxs(n,{display:"flex",alignItems:"center",children:[e.jsxs(s,{variant:"h5",component:"div",children:[((Y=r==null?void 0:r.performanceEfi)==null?void 0:Y.toFixed(2))??0,"%"]}),e.jsx(f,{color:((r==null?void 0:r.performanceEfi)??0)>0?"success":"error",sx:{ml:1}})]}),e.jsx(s,{variant:"caption",color:"text.secondary",children:((r==null?void 0:r.performanceEfi)??0)>0?"More than yesterday":"Less than yesterday"})]})})}),e.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:2,children:e.jsx(x,{sx:{height:"100%"},children:e.jsxs(p,{children:[e.jsx(s,{variant:"body2",color:"text.secondary",children:"LINE EFI"}),e.jsxs(n,{display:"flex",alignItems:"center",children:[e.jsxs(s,{variant:"h5",component:"div",children:[((R=r==null?void 0:r.lineEfi)==null?void 0:R.toFixed(2))??0,"%"]}),e.jsx(f,{color:((r==null?void 0:r.lineEfi)??0)>0?"success":"error",sx:{ml:1}})]}),e.jsx(s,{variant:"caption",color:"text.secondary",children:((r==null?void 0:r.lineEfi)??0)>0?"More than yesterday":"Less than yesterday"})]})})}),e.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:2,children:e.jsx(x,{sx:{height:"100%"},children:e.jsxs(p,{children:[e.jsx(s,{variant:"body2",color:"text.secondary",children:"Total Success"}),e.jsxs(n,{display:"flex",alignItems:"center",children:[e.jsx(s,{variant:"h5",component:"div",children:(r==null?void 0:r.totalSuccess)??0}),e.jsx(f,{color:"success",sx:{ml:1}})]}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"More than yesterday"})]})})}),e.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:2,children:e.jsx(x,{sx:{height:"100%"},children:e.jsxs(p,{children:[e.jsx(s,{variant:"body2",color:"text.secondary",children:"Total Rework"}),e.jsxs(n,{display:"flex",alignItems:"center",children:[e.jsx(s,{variant:"h5",component:"div",children:(r==null?void 0:r.totalRework)??0}),e.jsx(f,{color:"error",sx:{ml:1}})]}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"More than yesterday"})]})})}),e.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:2,children:e.jsx(x,{sx:{height:"100%"},children:e.jsxs(p,{children:[e.jsx(s,{variant:"body2",color:"text.secondary",children:"Total Defect"}),e.jsxs(n,{display:"flex",alignItems:"center",children:[e.jsx(s,{variant:"h5",component:"div",children:(r==null?void 0:r.totalDefect)??0}),e.jsx(f,{color:"error",sx:{ml:1}})]}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"More than yesterday"})]})})}),e.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:2,children:e.jsx(x,{sx:{height:"100%"},children:e.jsxs(p,{children:[e.jsx(s,{variant:"body2",color:"text.secondary",children:"TOP 3 DEFECTS"}),e.jsx(s,{variant:"h5",component:"div",children:((L=r==null?void 0:r.topDefects)==null?void 0:L.length)??0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:((T=r==null?void 0:r.topDefects)==null?void 0:T.map((a,j)=>e.jsxs("div",{children:[j+1,". ",a]},j)))??"No data available"})]})})})]}),e.jsx(n,{sx:{backgroundColor:"#ffffff",padding:2,borderRadius:1,mb:3,boxShadow:1},children:e.jsxs(i,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(i,{item:!0,xs:12,sm:4,children:e.jsx(O,{dateAdapter:G,children:e.jsx(q,{label:"Start Date",value:o,onChange:c,slotProps:{textField:{variant:"outlined",fullWidth:!0,size:"small"}}})})}),e.jsx(i,{item:!0,xs:12,sm:4,children:e.jsx(O,{dateAdapter:G,children:e.jsx(q,{label:"End Date",value:t,onChange:y,slotProps:{textField:{variant:"outlined",fullWidth:!0,size:"small"}}})})}),e.jsx(i,{item:!0,xs:12,sm:4,sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(d,{variant:"contained",color:"primary",onClick:re,sx:{height:"40px"},disabled:u,startIcon:u?e.jsx(xe,{size:20,color:"inherit"}):null,children:u?"Loading...":"View Reports"})})]})}),e.jsxs(Ce,{direction:"row",spacing:1,justifyContent:"flex-end",sx:{mb:1},children:[e.jsx(d,{startIcon:e.jsx(pe,{}),size:"small",children:"Copy"}),e.jsx(d,{startIcon:e.jsx(me,{}),size:"small",children:"Print"}),e.jsx(d,{startIcon:e.jsx(M,{}),size:"small",children:"Excel"}),e.jsx(d,{startIcon:e.jsx(M,{}),size:"small",children:"CSV"}),e.jsx(d,{startIcon:e.jsx(M,{}),size:"small",children:"PDF"})]}),e.jsx(n,{sx:{height:500,backgroundColor:"#fff",p:2,borderRadius:1,boxShadow:1},children:ae?e.jsx(n,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",children:e.jsx(s,{color:"error",children:"Error loading data"})}):e.jsx(Se,{rows:U||[],columns:ke,paginationModel:W,onPaginationModelChange:K,pageSizeOptions:[5,10,25],checkboxSelection:!0,loading:u})})]}),e.jsx(be,{})]}),e.jsx(we,{open:m.open,autoHideDuration:6e3,onClose:()=>v({...m,open:!1}),children:e.jsx(Me,{onClose:()=>v({...m,open:!1}),severity:m.severity,sx:{width:"100%"},children:m.message})})]})};export{rr as default};
